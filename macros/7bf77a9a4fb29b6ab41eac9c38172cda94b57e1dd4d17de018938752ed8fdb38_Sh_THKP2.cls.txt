Filename     : ./macros/7bf77a9a4fb29b6ab41eac9c38172cda94b57e1dd4d17de018938752ed8fdb38
OLE stream   : _VBA_PROJECT_CUR/VBA/Sh_THKP2
VBA filename : Sh_THKP2.cls
----------------------------------------
Attribute VB_Name = "Sh_THKP2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
On Error Resume Next
If KT_WbOP21(NameDT) = True Then
    Add_RightClickSheet ActiveSheet
    Run ("Reset_RightClick"): Run (NameDT & "!LoadPopup")
Else
    Run ("Reset_RightClick")
End If
End Sub
Private Sub Worksheet_Deactivate()
On Error Resume Next
  Run ("Reset_RightClick")
  If RegKeyRead("HKEY_CURRENT_USER\Software\BacNamSoft\Dutoan\AutoRename") = "1" Then
  If KTS21("Setting") = True Then Sheets("Setting").Range("G22").Value = Sh_THKP2.Name
  End If
End Sub
Function KTS21(NameSh As String) As Boolean
  On Error Resume Next
  KTS21 = CBool(Len(Worksheets(NameSh).Name) > 0)
End Function
Function KT_WbOP21(WBName As String) As Boolean
    Dim WB As Workbook
    On Error Resume Next
    Set WB = Workbooks(WBName)
    If Err = 0 Then KT_WbOP21 = True Else KT_WbOP21 = False
End Function
Private Sub Worksheet_Activate()
On Error Resume Next
If RegKeyRead("HKEY_CURRENT_USER\Software\BacNamSoft\Dutoan\Option\THKP\Auto_CPC") <> "1" Then Exit Sub
If RegKeyRead("HKEY_CURRENT_USER\Software\BacNamSoft\Dutoan\Option\ND32_2015") <> "1" Then Exit Sub
If RegKeyRead("HKEY_CURRENT_USER\Software\BacNamSoft\Dutoan\ThongtinCT\nsCPC") <> 1 Then Exit Sub
If RegKeyRead("HKEY_CURRENT_USER\Software\BacNamSoft\Dutoan\ThongtinCT\CPCTinhtheo") <> 1 Then Exit Sub
Dim rg As Long, rNoiSuy As Long, rSTT As Long
rg = EvalFind("G", ActiveSheet.Range("B:B")).Row
rNoiSuy = EvalFind("GNoisuy", Range("B:B")).Row
rSTT = EvalFind("STT", Range("A:A")).Row
If rNoiSuy = 0 Then Exit Sub
If rg = 0 Then Exit Sub
If rSTT = 0 Then Exit Sub
Dim soHM As Long, iHm As Long
soHM = WorksheetFunction.CountA(Range(Cells(rSTT, 6), Cells(rSTT, 256)))
If soHM >= 2 Then soHM = soHM - 1
Dim coTB As Boolean
Application.ScreenUpdating = False
'Application.Calculation = xlCalculationManual
For iHm = 1 To soHM
    If RegKeyRead("HKEY_CURRENT_USER\Software\BacNamSoft\Dutoan\Option\DGCT\CPC_HM") = "1" Then
        'Tinh theo tong hang muc
        If soHM = 1 Then soHM = 0
        If Range("E" & rNoiSuy).Offset(0, iHm).Value <> Range("E" & rg).Offset(0, soHM + 1).Value Then
            Application.Iteration = True
            Application.Calculation = xlCalculationAutomatic
            Range("E" & rNoiSuy).Offset(0, iHm).Value = Range("E" & rg).Offset(0, soHM + 1).Value
            Range("E" & rNoiSuy).Offset(0, iHm).Value = Range("E" & rg).Offset(0, soHM + 1).Value
            Application.Iteration = False
            coTB = True
            Exit For
        End If
    Else
        'Tinh theo tung hang muc
        If Range("E" & rNoiSuy).Offset(0, iHm).Value <> Range("E" & rg).Offset(0, iHm).Value Then
            Application.Iteration = True
            Application.Calculation = xlCalculationAutomatic
            Range("E" & rNoiSuy).Offset(0, iHm).Value = Range("E" & rg).Offset(0, iHm).Value
            Range("E" & rNoiSuy).Offset(0, iHm).Value = Range("E" & rg).Offset(0, iHm).Value
            Application.Iteration = False
            coTB = True
            Exit For
            coTB = True
            Exit For
        End If
    End If
Next
If coTB = True Then
    Application.Assistant.DoAlert UniConvert("Du75 toa1n BNSC", "VNI"), UniConvert("Ba3ng To63ng ho75p kinh phi1 d9a4 d9u7o75c ca65p nha65t d9i5nh mu71c ty3 le65 chi phi1 chung", "VNI"), msoAlertButtonOK, msoAlertIconInfo, 0, 0, 0
End If
Application.ScreenUpdating = True
'Application.Calculation = xlCalculationAutomatic
End Sub
